;存档功能
@SAVE_MAIN
SAVEGLOBAL
$S_001
FLAG:101 = 1
$S_002
CALL SAVE_SHOW,FLAG:101
INPUT
CLEARLINE 1
SELECTCASE RESULT
	CASE 0
			CALL MAIN
	CASE 101					;上一页存档
		IF FLAG:101 > 10
		FLAG:101 -= 10
		GOTO S_002
		ELSE 
		GOTO S_001
		ENDIF	
	CASE 102					;下一页存档
		IF FLAG:101 <= 91
		FLAG:101 += 10
		GOTO S_002
		ELSE 
		GOTO S_001
		ENDIF
	CASEELSE					;存档
		LOCAL = RESULT
		IF LOCAL > 0 && LOCAL < 101
			GETTIME
			SAVESTR:LOCAL = 名字:%CSTR:0:0%[LV:{BASE:0:等级}]%RESULTS%
			SAVEDATA LOCAL,SAVESTR:LOCAL
			GOTO S_002
		ELSE 
		GOTO S_002
		ENDIF
ENDSELECT
;读档功能
@LOAD_MAIN
$L_001
FLAG:101 = 1
$L_002
CALL SAVE_SHOW,FLAG:101
INPUT
CLEARLINE 1
SELECTCASE RESULT
	CASE 0
		IF FLAG:99 == 1
			CALL SYSTEM_TITLE
		ELSE
			CALL MAIN
		ENDIF
	CASE 101					;上一页存档
		IF FLAG:101 > 10
		FLAG:101 -= 10
		GOTO L_002
		ELSE 
		GOTO L_001
		ENDIF	
	CASE 102					;下一页存档
		IF FLAG:101 <= 91
		FLAG:101 += 10
		GOTO L_002
		ELSE 
		GOTO L_001
		ENDIF
	CASEELSE					;读档
		LOCAL = RESULT
		IF LOCAL > 0 && LOCAL < 101
			LOADDATA LOCAL
			IF FLAG:99 == 1
				CALL MAIN
			ELSE
				GOTO L_002
			ENDIF
		ELSE 
		GOTO L_002
		ENDIF
ENDSELECT

;存档显示
@SAVE_SHOW,ARG
LOCAL:1 = ARG
LOCAL:2 = LOCAL:1 + 9
FOR LOCAL,LOCAL:1,LOCAL:2
		CHKDATA LOCAL
		PRINTFORML [{LOCAL}]%RESULTS%
NEXT
DRAWLINE
PRINT [101]上一页
PRINT     
PRINTL [102]下一页
DRAWLINE
PRINTL [000]返回
RETURN RESULT

@CHECK_SAVE
GLOBAL:1 = 0
FOR LOCAL,1,100
	CHKDATA LOCAL
	IF RESULT == 0
		GLOBAL:1 += 1
	ELSE
		SAVESTR:LOCAL = 空存档
	ENDIF
NEXT
	
	




