;			ID  数量
@ADD_BLOCK,ID,NUM
#DIM ID
#DIM NUM
#DIM SUM
#DIM TEMP
#DIM PACK_USED
PACK_USED = 0
SUM = 0
FOR LOCAL,0,PACK_UNLOCK
	PACK_USED += 1
	$REM_1
	TEMP = 0
	IF NUM > 0 && PACK:LOCAL:0 == 0
		PACK:LOCAL:0 = ID
		GOTO REM_1
	ELSEIF PACK:LOCAL:0 == ID
		IF PACK:LOCAL:1 == BLOCK(ID,"MAX_NUM")
			CONTINUE
		ELSEIF PACK:LOCAL:1 < BLOCK(ID,"MAX_NUM")
			TEMP = PACK:LOCAL:1
			IF (PACK:LOCAL:1 + NUM) > BLOCK(ID,"MAX_NUM")
				PACK:LOCAL:1 = BLOCK(ID,"MAX_NUM")
				NUM = TEMP+NUM-BLOCK(ID,"MAX_NUM")
				SUM += BLOCK(ID,"MAX_NUM")-TEMP
				CONTINUE
			ELSEIF (PACK:LOCAL:1 + NUM)<BLOCK(ID,"MAX_NUM")
				PACK:LOCAL:1 += NUM
				SUM += NUM
				BREAK
			ENDIF
		ENDIF
	ELSE
	ENDIF
NEXT
CALL ADD_BLOCK_PRINT,ID,SUM
SIF NUM > 0 && PACK_USED == PACK_UNLOCK
	PRINTW 背包已满

@ADD_BLOCK_PRINT,LOCAL,ARG
PRINTFORM 获得{ARG}个
CALLFORM BLOCKNAME_{LOCAL}
PRINTW

@REMOVE_BLOCK,PACK_ID,NUM
#DIM PACK_ID
#DIM NUM
IF PACK:PACK_ID:1 > NUM
	PACK:PACK_ID:1 -=NUM
ELSEIF PACK:PACK_ID:1 == NUM
	PACK:PACK_ID:1 = 0
	PACK:PACK_ID:0 = 0
ENDIF

@DEL_BLOCK,ID,NUM
#DIM ID
#DIM NUM
#DIM PACK_ID
$REM_RECHECK
PACK_ID = FIND_PACK(ID,"PACK_ID")
IF PACK:PACK_ID:1 > NUM
	PACK:PACK_ID:1 -= NUM
ELSEIF PACK:PACK_ID:1 == NUM
	PACK:PACK_ID:1 =0
	PACK:PACK_ID:0 =0
ELSEIF PACK:PACK_ID:1 < NUM
	
	
ENDIF
;PACK索引总数量
@FIND_PACK(ID,FIND)
#FUNCTION
#DIM ID
#DIMS FIND
#DIM SUM
#DIM PACK_ID
PACK_ID = -1
FOR LOCAL,0,PACK_UNLOCK
	IF PACK:LOCAL:0 == ID
		SUM += PACK:LOCAL:1
		SIF PACK_ID < LOCAL
			PACK_ID = LOCAL
	ENDIF
NEXT
SELECTCASE FIND
	CASE "SUM"
		RETURNF SUM
	CASE "PACK_ID"
		RETURNF PACK_ID
	CASEELSE
ENDSELECT
	

;BLOCK索引
@BLOCK(ID,ARGS)
#FUNCTION
#DIM ID
CALLFORMF BLOCK_{ID}(ARGS,LOCAL)
RETURNF LOCAL
	
